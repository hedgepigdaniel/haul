{"version":3,"sources":["../../../src/webpack/resolvers/HasteResolver.ts"],"names":["HasteResolver","constructor","options","apply","resolver","hasteMap","directories","hasteOptions","hooks","resolve","tapAsync","request","context","callback","innerRequest","obj","Object","assign","doResolve"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAWA;;;AAGe,MAAMA,aAAN,CAAoB;AACjCC,EAAAA,WAAW,CAASC,OAAT,EAA2B;AAAA;AAAA;AAAE;;AAExCC,EAAAA,KAAK,CAACC,QAAD,EAAgB;AAAA;AACnB,UAAMC,QAAQ,2BAAG,iCACf,KAAKH,OAAL,CAAaI,WADE,EAEf,KAAKJ,OAAL,CAAaK,YAFE,CAAH,CAAd;AADmB;AAMnBH,IAAAA,QAAQ,CAACI,KAAT,CAAeC,OAAf,CAAuBC,QAAvB,CACE,mBADF,EAEE,CAACC,OAAD,EAAmBC,OAAnB,EAAqCC,QAArC,KAA4D;AAAA;AAC1D,YAAMC,YAAY,2BAAGH,OAAO,CAACA,OAAX,CAAlB;AAD0D;;AAG1D,UAAI,4BAACG,YAAD,gCAAiB,CAACT,QAAQ,CAACS,YAAD,CAA1B,CAAJ,EAA8C;AAAA;AAAA;AAC5C,eAAOD,QAAQ,EAAf;AACD,OAFD;AAAA;AAAA;;AAIA,YAAME,GAAG,2BAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBN,OAAlB,EAA2B;AACrCA,QAAAA,OAAO,EAAEN,QAAQ,CAACS,YAAD;AADoB,OAA3B,CAAH,CAAT;AAP0D;AAW1D,aAAOV,QAAQ,CAACc,SAAT,CACLd,QAAQ,CAACI,KAAT,CAAeC,OADV,EAELM,GAFK,EAGJ,WAAUD,YAAa,wBAAuBT,QAAQ,CAACS,YAAD,CAAe,EAHjE,EAILF,OAJK,EAKLC,QALK,CAAP;AAOD,KApBH;AAsBD;;AA/BgC","sourcesContent":["import findProvidesModule from './findProvidesModule';\n\ntype Request = {\n  request?: string;\n};\n\ntype Options = {\n  directories: Array<string>;\n  hasteOptions?: any;\n};\n\n/**\n * Resolver plugin that allows requiring haste modules with Webpack\n */\nexport default class HasteResolver {\n  constructor(private options: Options) {}\n\n  apply(resolver: any) {\n    const hasteMap = findProvidesModule(\n      this.options.directories,\n      this.options.hasteOptions\n    );\n\n    resolver.hooks.resolve.tapAsync(\n      'described-resolve',\n      (request: Request, context: unknown, callback: Function) => {\n        const innerRequest = request.request;\n\n        if (!innerRequest || !hasteMap[innerRequest]) {\n          return callback();\n        }\n\n        const obj = Object.assign({}, request, {\n          request: hasteMap[innerRequest],\n        });\n\n        return resolver.doResolve(\n          resolver.hooks.resolve,\n          obj,\n          `Aliased ${innerRequest} with haste mapping: ${hasteMap[innerRequest]}`,\n          context,\n          callback\n        );\n      }\n    );\n  }\n}\n"],"file":"HasteResolver.js"}